<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Voter Voting Power Snapshot and Vote Storage Table - Catalyst Voting System - Core Technology</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././book/assets/css/mdbook-admonish.css">
        <link rel="stylesheet" href=".././book/assets/css/open-in.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../00_prologue.html">Prologue</a></li><li class="chapter-item "><a href="../01_intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item "><a href="../02_core_ledger/index.html"><strong aria-hidden="true">2.</strong> Core Ledger</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/01_concepts/index.html"><strong aria-hidden="true">2.1.</strong> General Concepts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/01_concepts/blockchain.html"><strong aria-hidden="true">2.1.1.</strong> Blockchain concepts</a></li><li class="chapter-item "><a href="../02_core_ledger/01_concepts/network.html"><strong aria-hidden="true">2.1.2.</strong> Network overview</a></li><li class="chapter-item "><a href="../02_core_ledger/01_concepts/node.html"><strong aria-hidden="true">2.1.3.</strong> Node organization</a></li><li class="chapter-item "><a href="../02_core_ledger/01_concepts/stake.html"><strong aria-hidden="true">2.1.4.</strong> Stake</a></li></ol></li><li class="chapter-item "><a href="../02_core_ledger/02_quickstart/index.html"><strong aria-hidden="true">2.2.</strong> Quickstart</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/02_quickstart/01_command_line.html"><strong aria-hidden="true">2.2.1.</strong> Command line tools</a></li><li class="chapter-item "><a href="../02_core_ledger/02_quickstart/02_passive_node.html"><strong aria-hidden="true">2.2.2.</strong> Starting a passive node</a></li><li class="chapter-item "><a href="../02_core_ledger/02_quickstart/03_rest_api.html"><strong aria-hidden="true">2.2.3.</strong> REST Api</a></li><li class="chapter-item "><a href="../02_core_ledger/02_quickstart/04_explorer.html"><strong aria-hidden="true">2.2.4.</strong> Explorer mode</a></li><li class="chapter-item "><a href="../02_core_ledger/02_quickstart/05_leader_candidate.html"><strong aria-hidden="true">2.2.5.</strong> How to start a node as a leader candidate</a></li></ol></li><li class="chapter-item "><a href="../02_core_ledger/03_configuration/index.html"><strong aria-hidden="true">2.3.</strong> Configuration</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/03_configuration/leadership.html"><strong aria-hidden="true">2.3.1.</strong> Leadership</a></li><li class="chapter-item "><a href="../02_core_ledger/03_configuration/logging.html"><strong aria-hidden="true">2.3.2.</strong> Logging</a></li><li class="chapter-item "><a href="../02_core_ledger/03_configuration/mempool.html"><strong aria-hidden="true">2.3.3.</strong> Mempool</a></li><li class="chapter-item "><a href="../02_core_ledger/03_configuration/network.html"><strong aria-hidden="true">2.3.4.</strong> Node network</a></li><li class="chapter-item "><a href="../02_core_ledger/03_configuration/prometheus.html"><strong aria-hidden="true">2.3.5.</strong> Prometheus</a></li></ol></li><li class="chapter-item "><a href="../02_core_ledger/04_jcli/index.html"><strong aria-hidden="true">2.4.</strong> jcli</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/04_jcli/address.html"><strong aria-hidden="true">2.4.1.</strong> Address</a></li><li class="chapter-item "><a href="../02_core_ledger/04_jcli/certificate.html"><strong aria-hidden="true">2.4.2.</strong> Certificate</a></li><li class="chapter-item "><a href="../02_core_ledger/04_jcli/genesis.html"><strong aria-hidden="true">2.4.3.</strong> Genesis</a></li><li class="chapter-item "><a href="../02_core_ledger/04_jcli/key.html"><strong aria-hidden="true">2.4.4.</strong> cryptographic keys</a></li><li class="chapter-item "><a href="../02_core_ledger/04_jcli/rest.html"><strong aria-hidden="true">2.4.5.</strong> REST</a></li><li class="chapter-item "><a href="../02_core_ledger/04_jcli/transaction.html"><strong aria-hidden="true">2.4.6.</strong> Transaction</a></li><li class="chapter-item "><a href="../02_core_ledger/04_jcli/vote.html"><strong aria-hidden="true">2.4.7.</strong> Voting</a></li></ol></li><li class="chapter-item "><a href="../02_core_ledger/05_stake_pool/index.html"><strong aria-hidden="true">2.5.</strong> Staking with Jörmungandr</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/05_stake_pool/delegating_stake.html"><strong aria-hidden="true">2.5.1.</strong> Delegating your stake</a></li><li class="chapter-item "><a href="../02_core_ledger/05_stake_pool/registering_stake_pool.html"><strong aria-hidden="true">2.5.2.</strong> Registering a stake pool</a></li><li class="chapter-item "><a href="../02_core_ledger/05_stake_pool/retiring_stake_pool.html"><strong aria-hidden="true">2.5.3.</strong> Retiring a stake pool</a></li></ol></li><li class="chapter-item "><a href="../02_core_ledger/06_advanced/index.html"><strong aria-hidden="true">2.6.</strong> Advanced</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/06_advanced/01_the_genesis_block.html"><strong aria-hidden="true">2.6.1.</strong> genesis file</a></li><li class="chapter-item "><a href="../02_core_ledger/06_advanced/02_starting_bft_blockchain.html"><strong aria-hidden="true">2.6.2.</strong> starting a bft node</a></li><li class="chapter-item "><a href="../02_core_ledger/06_advanced/03_starting_genesis_praos_blockchain.html"><strong aria-hidden="true">2.6.3.</strong> starting a genesis blockchain</a></li><li class="chapter-item "><a href="../02_core_ledger/06_advanced/04_vote_fragments_voteplan_blockchain_relationships.html"><strong aria-hidden="true">2.6.4.</strong> How Vote plans, Vote Fragments and the blockchain transaction work and inter-relate</a></li></ol></li><li class="chapter-item "><a href="../02_core_ledger/07_specs/index.html"><strong aria-hidden="true">2.7.</strong> Jormungandr Specifications</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/07_specs/migration.html"><strong aria-hidden="true">2.7.1.</strong> MIGRATION</a></li><li class="chapter-item "><a href="../02_core_ledger/07_specs/network.html"><strong aria-hidden="true">2.7.2.</strong> Network</a></li></ol></li><li class="chapter-item "><a href="../02_core_ledger/08_testing/index.html"><strong aria-hidden="true">2.8.</strong> testing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/08_testing/automation.html"><strong aria-hidden="true">2.8.1.</strong> jormungandr-automation</a></li><li class="chapter-item "><a href="../02_core_ledger/08_testing/hersir.html"><strong aria-hidden="true">2.8.2.</strong> Hersir</a></li><li class="chapter-item "><a href="../02_core_ledger/08_testing/integration_tests.html"><strong aria-hidden="true">2.8.3.</strong> jormungandr-integration-tests</a></li><li class="chapter-item "><a href="../02_core_ledger/08_testing/loki.html"><strong aria-hidden="true">2.8.4.</strong> Loki</a></li><li class="chapter-item "><a href="../02_core_ledger/08_testing/mjolnir.html"><strong aria-hidden="true">2.8.5.</strong> Mjolnir</a></li><li class="chapter-item "><a href="../02_core_ledger/08_testing/thor.html"><strong aria-hidden="true">2.8.6.</strong> Thor</a></li></ol></li><li class="chapter-item "><a href="../02_core_ledger/09_internal_design/index.html"><strong aria-hidden="true">2.9.</strong> Internal Design</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../02_core_ledger/09_internal_design/01_auto-start.html"><strong aria-hidden="true">2.9.1.</strong> Automatic deployment of the voting blockchain</a></li><li class="chapter-item "><a href="../02_core_ledger/09_internal_design/02_permissionless_auth.html"><strong aria-hidden="true">2.9.2.</strong> Permissionless Auth</a></li></ol></li></ol></li><li class="chapter-item "><a href="../03_core_testing/index.html"><strong aria-hidden="true">3.</strong> Catalyst testing User Guide</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/iapyx/index.html"><strong aria-hidden="true">3.1.</strong> Iapyx</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/iapyx/iapyx.html"><strong aria-hidden="true">3.1.1.</strong> Iapyx</a></li><li class="chapter-item "><a href="../03_core_testing/iapyx/load.html"><strong aria-hidden="true">3.1.2.</strong> Iapyx Load</a></li></ol></li><li class="chapter-item "><a href="../03_core_testing/integration-tests/index.html"><strong aria-hidden="true">3.2.</strong> integration-tests</a></li><li class="chapter-item "><a href="../03_core_testing/registration-service/index.html"><strong aria-hidden="true">3.3.</strong> Registration service</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/registration-service/cli.html"><strong aria-hidden="true">3.3.1.</strong> Registration CLI</a></li><li class="chapter-item "><a href="../03_core_testing/registration-service/configuration.html"><strong aria-hidden="true">3.3.2.</strong> Configuration</a></li></ol></li><li class="chapter-item "><a href="../03_core_testing/registration-verify-service/index.html"><strong aria-hidden="true">3.4.</strong> Registration service</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/registration-verify-service/cli.html"><strong aria-hidden="true">3.4.1.</strong> Registration Verify CLI</a></li><li class="chapter-item "><a href="../03_core_testing/registration-verify-service/configuration.html"><strong aria-hidden="true">3.4.2.</strong> Configuration</a></li></ol></li><li class="chapter-item "><a href="../03_core_testing/snapshot-service/index.html"><strong aria-hidden="true">3.5.</strong> Snapshot trigger service</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/snapshot-service/cli.html"><strong aria-hidden="true">3.5.1.</strong> Registration CLI</a></li><li class="chapter-item "><a href="../03_core_testing/snapshot-service/configuration.html"><strong aria-hidden="true">3.5.2.</strong> Configuration</a></li></ol></li><li class="chapter-item "><a href="../03_core_testing/snapshot-wormhole/index.html"><strong aria-hidden="true">3.6.</strong> snapshot wormhole</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/snapshot-wormhole/configuration.html"><strong aria-hidden="true">3.6.1.</strong> Configuration</a></li></ol></li><li class="chapter-item "><a href="../03_core_testing/valgrind/index.html"><strong aria-hidden="true">3.7.</strong> valgrind</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/valgrind/configuration.html"><strong aria-hidden="true">3.7.1.</strong> Configuration</a></li></ol></li><li class="chapter-item "><a href="../03_core_testing/vitup/index.html"><strong aria-hidden="true">3.8.</strong> vitup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/vitup/configuration.html"><strong aria-hidden="true">3.8.1.</strong> Configuration</a></li><li class="chapter-item "><a href="../03_core_testing/vitup/data_generation/index.html"><strong aria-hidden="true">3.8.2.</strong> Data Generation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../03_core_testing/vitup/data_generation/reset.html"><strong aria-hidden="true">3.8.2.1.</strong> Configuration</a></li><li class="chapter-item "><a href="../03_core_testing/vitup/data_generation/snapshot.html"><strong aria-hidden="true">3.8.2.2.</strong> Configuration</a></li></ol></li><li class="chapter-item "><a href="../03_core_testing/vitup/data_generation.html"><strong aria-hidden="true">3.8.3.</strong> Data Generation</a></li><li class="chapter-item "><a href="../03_core_testing/vitup/mock.html"><strong aria-hidden="true">3.8.4.</strong> Mock</a></li><li class="chapter-item "><a href="../03_core_testing/vitup/mock_farm.html"><strong aria-hidden="true">3.8.5.</strong> Mock Farm</a></li><li class="chapter-item "><a href="../03_core_testing/vitup/run_modes.html"><strong aria-hidden="true">3.8.6.</strong> Configuration modes</a></li></ol></li></ol></li><li class="chapter-item "><a href="../04_core_vitss/index.html"><strong aria-hidden="true">4.</strong> Core VIT Servicing Station</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../04_core_vitss/testing.html"><strong aria-hidden="true">4.1.</strong> vit-servicing-station-tests</a></li></ol></li><li class="chapter-item "><a href="../05_unified_platform/index.html"><strong aria-hidden="true">5.</strong> Unified Platform</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/index.html"><strong aria-hidden="true">5.1.</strong> Overview</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/01_cardano_nodes.html"><strong aria-hidden="true">5.1.1.</strong> Cardano Nodes</a></li><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/02_bridge_pipeline/index.html"><strong aria-hidden="true">5.1.2.</strong> Bridge Pipeline</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/02_bridge_pipeline/01_block_reader.html"><strong aria-hidden="true">5.1.2.1.</strong> Block Reader</a></li></ol></li><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/03_rest_http_service.html"><strong aria-hidden="true">5.1.3.</strong> REST HTTP Service</a></li><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/04_event_stream.html"><strong aria-hidden="true">5.1.4.</strong> Event Stream</a></li><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/05_database/index.html"><strong aria-hidden="true">5.1.5.</strong> Database</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/05_database/01_registration_db.html"><strong aria-hidden="true">5.1.5.1.</strong> Registrations Database</a></li><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/05_database/02_staked_ada_db.html"><strong aria-hidden="true">5.1.5.2.</strong> Staked ADA Database</a></li><li class="chapter-item "><a href="../05_unified_platform/01_catalyst-cardano-bridge/05_database/03_transaction_state.html"><strong aria-hidden="true">5.1.5.3.</strong> Transaction State Database</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><a href="../06_rust_api/index.html"><strong aria-hidden="true">6.</strong> Rust API</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../06_rust_api/rust_style_guide.html"><strong aria-hidden="true">6.1.</strong> 🦀 Rust Style Guide</a></li></ol></li><li class="chapter-item "><a href="../07_web_api/index.html"><strong aria-hidden="true">7.</strong> Web API</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../07_web_api/catalyst-core-api.html"><strong aria-hidden="true">7.1.</strong> Catalyst Core API V1</a></li><li class="chapter-item "><a href="../07_web_api/dbsync-explorer.html"><strong aria-hidden="true">7.2.</strong> dbSync Explorer HTTP/REST API V1</a></li><li class="chapter-item "><a href="../07_web_api/vit-servicing-station-v0.html"><strong aria-hidden="true">7.3.</strong> VIT Servicing Station HTTP/REST API V0</a></li><li class="chapter-item "><a href="../07_web_api/vit-testing-mock-farm-v0.html"><strong aria-hidden="true">7.4.</strong> VIT Testing Mock Farm HTTP/REST API V0</a></li><li class="chapter-item "><a href="../07_web_api/vit-testing-mock-v0.html"><strong aria-hidden="true">7.5.</strong> VIT Testing Mock HTTP/REST API V0</a></li><li class="chapter-item "><a href="../07_web_api/vote-ledger-v0.html"><strong aria-hidden="true">7.6.</strong> Vote Ledger HTTP/REST API V0</a></li><li class="chapter-item "><a href="../07_web_api/vote-ledger-v1.html"><strong aria-hidden="true">7.7.</strong> Vote Ledger HTTP/REST API V1</a></li></ol></li><li class="chapter-item expanded "><a href="../08_event-db/index.html"><strong aria-hidden="true">8.</strong> Event DB crate</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../08_event-db/01_development.html"><strong aria-hidden="true">8.1.</strong> Event DB Local Development</a></li><li class="chapter-item "><a href="../08_event-db/02_config-tables.html"><strong aria-hidden="true">8.2.</strong> General Configuration</a></li><li class="chapter-item "><a href="../08_event-db/03_event-table.html"><strong aria-hidden="true">8.3.</strong> Event Definition Table</a></li><li class="chapter-item "><a href="../08_event-db/04_objective_tables.html"><strong aria-hidden="true">8.4.</strong> Objective and Proposal  Tables</a></li><li class="chapter-item "><a href="../08_event-db/05_vote_plans.html"><strong aria-hidden="true">8.5.</strong> Vote Plan Tables</a></li><li class="chapter-item expanded "><a href="../08_event-db/06_snapshot_tables.html" class="active"><strong aria-hidden="true">8.6.</strong> Voter Voting Power Snapshot and Vote Storage Table</a></li><li class="chapter-item "><a href="../08_event-db/07_automation_support.html"><strong aria-hidden="true">8.7.</strong> Catalyst Automation Support Tables</a></li><li class="chapter-item "><a href="../08_event-db/08_vitss.html"><strong aria-hidden="true">8.8.</strong> VitSS Compatibility</a></li></ol></li><li class="chapter-item "><a href="../97_CONTRIBUTING.html"><strong aria-hidden="true">9.</strong> Contributing to Catalyst Core</a></li><li class="chapter-item "><a href="../98_CODE_OF_CONDUCT.html"><strong aria-hidden="true">10.</strong> Contributor Covenant Code of Conduct</a></li><li class="chapter-item "><a href="../99_example_enhanced_markup.html"><strong aria-hidden="true">11.</strong> Example Enhanced Markup</a></li><li class="chapter-item affix "><a href="../ZZ_suffix.html">Suffix</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Catalyst Voting System - Core Technology</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/input-output-hk/catalyst-core" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="voter-voting-power-snapshot-and-vote-storage-table"><a class="header" href="#voter-voting-power-snapshot-and-vote-storage-table">Voter Voting Power Snapshot and Vote Storage Table</a></h1>
<p>This table stores:</p>
<ul>
<li>The details of each registration and voting power of each voter.</li>
<li>The results of the latest snapshots for each event.</li>
<li>The record of all votes cast by voters.</li>
</ul>
<h2 id="snapshot--vote-table-diagram"><a class="header" href="#snapshot--vote-table-diagram">Snapshot &amp; Vote Table Diagram</a></h2>
<pre><svg width="1842pt" height="1442pt"
 viewBox="0.00 0.00 1842.00 1442.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1438)">
<title>erd</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1438 1838,-1438 1838,4 -4,4"/>
<text text-anchor="middle" x="917" y="-1401.5" font-family="Times,serif" font-size="30.00" fill="blue">Catalyst Event Database &#45; Snapshot</text>
<!-- ballot -->
<g id="node1" class="node">
<title>ballot</title>
<polygon fill="#009879" stroke="none" points="0,-890 0,-920 484,-920 484,-890 0,-890"/>
<polygon fill="none" stroke="black" points="0,-890 0,-920 484,-920 484,-890 0,-890"/>
<text text-anchor="start" x="214.5" y="-899" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">ballot</text>
<polygon fill="none" stroke="black" points="0,-863 0,-890 95,-890 95,-863 0,-863"/>
<text text-anchor="start" x="13" y="-870.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="95,-863 95,-890 168,-890 168,-863 95,-863"/>
<text text-anchor="start" x="111" y="-870.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Type</text>
<polygon fill="none" stroke="black" points="168,-863 168,-890 484,-890 484,-863 168,-863"/>
<text text-anchor="start" x="275.5" y="-870.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Description</text>
<polygon fill="#54ff9f" stroke="none" points="0,-838 0,-863 95,-863 95,-838 0,-838"/>
<polygon fill="none" stroke="black" points="0,-838 0,-863 95,-863 95,-838 0,-838"/>
<text text-anchor="start" x="3" y="-844.8" font-family="Times,serif" font-size="16.00">row_id</text>
<polygon fill="#54ff9f" stroke="none" points="95,-838 95,-863 168,-863 168,-838 95,-838"/>
<polygon fill="none" stroke="black" points="95,-838 95,-863 168,-863 168,-838 95,-838"/>
<text text-anchor="start" x="108.5" y="-844.8" font-family="Times,serif" font-size="16.00">bigint+</text>
<polygon fill="#54ff9f" stroke="none" points="168,-838 168,-863 484,-863 484,-838 168,-838"/>
<polygon fill="none" stroke="black" points="168,-838 168,-863 484,-863 484,-838 168,-838"/>
<text text-anchor="start" x="171" y="-846.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">none</text>
<polygon fill="none" stroke="black" points="0,-804 0,-838 95,-838 95,-804 0,-804"/>
<text text-anchor="start" x="3" y="-815.4" font-family="Times,serif" font-size="16.00">objective</text>
<polygon fill="none" stroke="black" points="95,-804 95,-838 168,-838 168,-804 95,-804"/>
<text text-anchor="start" x="109.5" y="-815.4" font-family="Times,serif" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="168,-804 168,-838 484,-838 484,-804 168,-804"/>
<text text-anchor="start" x="171" y="-822.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Reference to the Objective the ballot</text>
<text text-anchor="start" x="171" y="-808.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">was for.</text>
<polygon fill="none" stroke="black" points="0,-742 0,-804 95,-804 95,-742 0,-742"/>
<text text-anchor="start" x="3" y="-767.4" font-family="Times,serif" font-size="16.00">proposal</text>
<polygon fill="none" stroke="black" points="95,-742 95,-804 168,-804 168,-742 95,-742"/>
<text text-anchor="start" x="109.5" y="-768.4" font-family="Times,serif" font-style="italic" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="168,-742 168,-804 484,-804 484,-742 168,-742"/>
<text text-anchor="start" x="171" y="-788.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Reference to the Proposal the ballot</text>
<text text-anchor="start" x="171" y="-774.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">was for.</text>
<text text-anchor="start" x="171" y="-760.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">May be NULL if this ballot covers ALL</text>
<text text-anchor="start" x="171" y="-746.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">proposals in the challenge.</text>
<polygon fill="none" stroke="black" points="0,-708 0,-742 95,-742 95,-708 0,-708"/>
<text text-anchor="start" x="3" y="-719.4" font-family="Times,serif" font-size="16.00">voter</text>
<polygon fill="none" stroke="black" points="95,-708 95,-742 168,-742 168,-708 95,-708"/>
<text text-anchor="start" x="109.5" y="-719.4" font-family="Times,serif" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="168,-708 168,-742 484,-742 484,-708 168,-708"/>
<text text-anchor="start" x="171" y="-726.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Reference to the Voter who cast the</text>
<text text-anchor="start" x="171" y="-712.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">ballot</text>
<polygon fill="none" stroke="black" points="0,-683 0,-708 95,-708 95,-683 0,-683"/>
<text text-anchor="start" x="3" y="-689.8" font-family="Times,serif" font-size="16.00">fragment_id</text>
<polygon fill="none" stroke="black" points="95,-683 95,-708 168,-708 168,-683 95,-683"/>
<text text-anchor="start" x="119.5" y="-689.8" font-family="Times,serif" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="168,-683 168,-708 484,-708 484,-683 168,-683"/>
<text text-anchor="start" x="171" y="-691.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Unique ID of this Ballot</text>
<polygon fill="none" stroke="black" points="0,-649 0,-683 95,-683 95,-649 0,-649"/>
<text text-anchor="start" x="3" y="-660.4" font-family="Times,serif" font-size="16.00">cast_at</text>
<polygon fill="none" stroke="black" points="95,-649 95,-683 168,-683 168,-649 95,-649"/>
<text text-anchor="start" x="98" y="-660.4" font-family="Times,serif" font-size="16.00">timestamp</text>
<polygon fill="none" stroke="black" points="168,-649 168,-683 484,-683 484,-649 168,-649"/>
<text text-anchor="start" x="171" y="-667.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">When this ballot was recorded as</text>
<text text-anchor="start" x="171" y="-653.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">properly cast</text>
<polygon fill="none" stroke="black" points="0,-615 0,-649 95,-649 95,-615 0,-615"/>
<text text-anchor="start" x="3" y="-626.4" font-family="Times,serif" font-size="16.00">choice</text>
<polygon fill="none" stroke="black" points="95,-615 95,-649 168,-649 168,-615 95,-615"/>
<text text-anchor="start" x="105.5" y="-627.4" font-family="Times,serif" font-style="italic" font-size="16.00">smallint</text>
<polygon fill="none" stroke="black" points="168,-615 168,-649 484,-649 484,-615 168,-615"/>
<text text-anchor="start" x="171" y="-633.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">If a public vote, the choice on the</text>
<text text-anchor="start" x="171" y="-619.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">ballot, otherwise NULL.</text>
<polygon fill="none" stroke="black" points="0,-590 0,-615 95,-615 95,-590 0,-590"/>
<text text-anchor="start" x="3" y="-596.8" font-family="Times,serif" font-size="16.00">raw_fragment</text>
<polygon fill="none" stroke="black" points="95,-590 95,-615 168,-615 168,-590 95,-590"/>
<text text-anchor="start" x="114.5" y="-596.8" font-family="Times,serif" font-size="16.00">bytea</text>
<polygon fill="none" stroke="black" points="168,-590 168,-615 484,-615 484,-590 168,-590"/>
<text text-anchor="start" x="171" y="-598.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The raw ballot record.</text>
<polygon fill="#333333" stroke="none" points="0,-568 0,-590 484,-590 484,-568 0,-568"/>
<polygon fill="none" stroke="black" points="0,-568 0,-590 484,-590 484,-568 0,-568"/>
<text text-anchor="start" x="3" y="-574.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">All Ballots cast on an event.</text>
</g>
<!-- voter -->
<g id="node5" class="node">
<title>voter</title>
<polygon fill="#009879" stroke="none" points="547.5,-710 547.5,-740 1026.5,-740 1026.5,-710 547.5,-710"/>
<polygon fill="none" stroke="black" points="547.5,-710 547.5,-740 1026.5,-740 1026.5,-710 547.5,-710"/>
<text text-anchor="start" x="761" y="-719" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">voter</text>
<polygon fill="none" stroke="black" points="547.5,-683 547.5,-710 641.5,-710 641.5,-683 547.5,-683"/>
<text text-anchor="start" x="560" y="-690.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="641.5,-683 641.5,-710 693.5,-710 693.5,-683 641.5,-683"/>
<text text-anchor="start" x="647" y="-690.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Type</text>
<polygon fill="none" stroke="black" points="693.5,-683 693.5,-710 1026.5,-710 1026.5,-683 693.5,-683"/>
<text text-anchor="start" x="809.5" y="-690.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Description</text>
<polygon fill="#54ff9f" stroke="none" points="547.5,-658 547.5,-683 641.5,-683 641.5,-658 547.5,-658"/>
<polygon fill="none" stroke="black" points="547.5,-658 547.5,-683 641.5,-683 641.5,-658 547.5,-658"/>
<text text-anchor="start" x="550.5" y="-664.8" font-family="Times,serif" font-size="16.00">row_id</text>
<polygon fill="#54ff9f" stroke="none" points="641.5,-658 641.5,-683 693.5,-683 693.5,-658 641.5,-658"/>
<polygon fill="none" stroke="black" points="641.5,-658 641.5,-683 693.5,-683 693.5,-658 641.5,-658"/>
<text text-anchor="start" x="644.5" y="-664.8" font-family="Times,serif" font-size="16.00">bigint+</text>
<polygon fill="#54ff9f" stroke="none" points="693.5,-658 693.5,-683 1026.5,-683 1026.5,-658 693.5,-658"/>
<polygon fill="none" stroke="black" points="693.5,-658 693.5,-683 1026.5,-683 1026.5,-658 693.5,-658"/>
<text text-anchor="start" x="696.5" y="-666.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">none</text>
<polygon fill="none" stroke="black" points="547.5,-633 547.5,-658 641.5,-658 641.5,-633 547.5,-633"/>
<text text-anchor="start" x="550.5" y="-639.8" font-family="Times,serif" font-size="16.00">voting_key</text>
<polygon fill="none" stroke="black" points="641.5,-633 641.5,-658 693.5,-658 693.5,-633 641.5,-633"/>
<text text-anchor="start" x="655.5" y="-639.8" font-family="Times,serif" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="693.5,-633 693.5,-658 1026.5,-658 1026.5,-633 693.5,-633"/>
<text text-anchor="start" x="696.5" y="-641.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Either the voting key.</text>
<polygon fill="none" stroke="black" points="547.5,-599 547.5,-633 641.5,-633 641.5,-599 547.5,-599"/>
<text text-anchor="start" x="550.5" y="-610.4" font-family="Times,serif" font-size="16.00">snapshot_id</text>
<polygon fill="none" stroke="black" points="641.5,-599 641.5,-633 693.5,-633 693.5,-599 641.5,-599"/>
<text text-anchor="start" x="645.5" y="-610.4" font-family="Times,serif" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="693.5,-599 693.5,-633 1026.5,-633 1026.5,-599 693.5,-599"/>
<text text-anchor="start" x="696.5" y="-617.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The ID of the snapshot this record</text>
<text text-anchor="start" x="696.5" y="-603.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">belongs to.</text>
<polygon fill="none" stroke="black" points="547.5,-574 547.5,-599 641.5,-599 641.5,-574 547.5,-574"/>
<text text-anchor="start" x="550.5" y="-580.8" font-family="Times,serif" font-size="16.00">voting_group</text>
<polygon fill="none" stroke="black" points="641.5,-574 641.5,-599 693.5,-599 693.5,-574 641.5,-574"/>
<text text-anchor="start" x="655.5" y="-580.8" font-family="Times,serif" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="693.5,-574 693.5,-599 1026.5,-599 1026.5,-574 693.5,-574"/>
<text text-anchor="start" x="696.5" y="-582.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The voter group the voter belongs to.</text>
<polygon fill="none" stroke="black" points="547.5,-540 547.5,-574 641.5,-574 641.5,-540 547.5,-540"/>
<text text-anchor="start" x="550.5" y="-551.4" font-family="Times,serif" font-size="16.00">voting_power</text>
<polygon fill="none" stroke="black" points="641.5,-540 641.5,-574 693.5,-574 693.5,-540 641.5,-540"/>
<text text-anchor="start" x="649" y="-551.4" font-family="Times,serif" font-size="16.00">bigint</text>
<polygon fill="none" stroke="black" points="693.5,-540 693.5,-574 1026.5,-574 1026.5,-540 693.5,-540"/>
<text text-anchor="start" x="696.5" y="-558.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Calculated Voting Power associated with</text>
<text text-anchor="start" x="696.5" y="-544.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">this key.</text>
<polygon fill="#333333" stroke="none" points="547.5,-518 547.5,-540 1026.5,-540 1026.5,-518 547.5,-518"/>
<polygon fill="none" stroke="black" points="547.5,-518 547.5,-540 1026.5,-540 1026.5,-518 547.5,-518"/>
<text text-anchor="start" x="550.5" y="-524.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">Voting Power for every voting key.</text>
</g>
<!-- ballot&#45;&gt;voter -->
<g id="edge7" class="edge">
<title>ballot:voter_out&#45;&gt;voter:row_id</title>
<path fill="none" stroke="black" d="M484,-725C516.4,-725 511.36,-682.54 535.28,-672.92"/>
<polygon fill="black" stroke="black" points="535.77,-676.21 545,-671 534.54,-669.32 535.77,-676.21"/>
</g>
<!-- objective -->
<g id="node7" class="node">
<title>objective</title>
<polygon fill="#009879" stroke="none" points="738.5,-836 738.5,-866 835.5,-866 835.5,-836 738.5,-836"/>
<polygon fill="none" stroke="black" points="738.5,-836 738.5,-866 835.5,-866 835.5,-836 738.5,-836"/>
<text text-anchor="start" x="741.5" y="-845" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">objective</text>
<polygon fill="none" stroke="black" points="738.5,-809 738.5,-836 835.5,-836 835.5,-809 738.5,-809"/>
<text text-anchor="start" x="752.5" y="-816.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="738.5,-784 738.5,-809 835.5,-809 835.5,-784 738.5,-784"/>
<text text-anchor="start" x="741.5" y="-790.8" font-family="Times,serif" font-size="16.00">row_id</text>
<polygon fill="#333333" stroke="none" points="738.5,-762 738.5,-784 835.5,-784 835.5,-762 738.5,-762"/>
<polygon fill="none" stroke="black" points="738.5,-762 738.5,-784 835.5,-784 835.5,-762 738.5,-762"/>
<text text-anchor="start" x="741.5" y="-768.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">ABRIDGED</text>
</g>
<!-- ballot&#45;&gt;objective -->
<g id="edge8" class="edge">
<title>ballot:objective_out&#45;&gt;objective:row_id</title>
<path fill="none" stroke="black" d="M484,-821C593.24,-821 622.12,-797.63 726.02,-796.08"/>
<polygon fill="black" stroke="black" points="726.03,-799.57 736,-796 725.97,-792.57 726.03,-799.57"/>
</g>
<!-- proposal -->
<g id="node8" class="node">
<title>proposal</title>
<polygon fill="#009879" stroke="none" points="742,-966 742,-996 832,-996 832,-966 742,-966"/>
<polygon fill="none" stroke="black" points="742,-966 742,-996 832,-996 832,-966 742,-966"/>
<text text-anchor="start" x="745" y="-975" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">proposal</text>
<polygon fill="none" stroke="black" points="742,-939 742,-966 832,-966 832,-939 742,-939"/>
<text text-anchor="start" x="752.5" y="-946.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="742,-914 742,-939 832,-939 832,-914 742,-914"/>
<text text-anchor="start" x="745" y="-920.8" font-family="Times,serif" font-size="16.00">row_id</text>
<polygon fill="#333333" stroke="none" points="742,-892 742,-914 832,-914 832,-892 742,-892"/>
<polygon fill="none" stroke="black" points="742,-892 742,-914 832,-914 832,-892 742,-892"/>
<text text-anchor="start" x="745" y="-898.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">ABRIDGED</text>
</g>
<!-- ballot&#45;&gt;proposal -->
<g id="edge9" class="edge">
<title>ballot:proposal_out&#45;&gt;proposal:row_id</title>
<path fill="none" stroke="black" d="M484,-773C533.75,-773 482.81,-845.95 520,-879 592.28,-943.23 637.16,-927.34 730.04,-926.08"/>
<polygon fill="black" stroke="black" points="730.02,-929.57 740,-926 729.98,-922.57 730.02,-929.57"/>
</g>
<!-- contribution -->
<g id="node2" class="node">
<title>contribution</title>
<polygon fill="#009879" stroke="none" points="520,-1360 520,-1390 1054,-1390 1054,-1360 520,-1360"/>
<polygon fill="none" stroke="black" points="520,-1360 520,-1390 1054,-1390 1054,-1360 520,-1360"/>
<text text-anchor="start" x="726.5" y="-1369" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">contribution</text>
<polygon fill="none" stroke="black" points="520,-1333 520,-1360 653,-1360 653,-1333 520,-1333"/>
<text text-anchor="start" x="552" y="-1340.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="653,-1333 653,-1360 713,-1360 713,-1333 653,-1333"/>
<text text-anchor="start" x="662.5" y="-1340.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Type</text>
<polygon fill="none" stroke="black" points="713,-1333 713,-1360 1054,-1360 1054,-1333 713,-1333"/>
<text text-anchor="start" x="833" y="-1340.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Description</text>
<polygon fill="#54ff9f" stroke="none" points="520,-1308 520,-1333 653,-1333 653,-1308 520,-1308"/>
<polygon fill="none" stroke="black" points="520,-1308 520,-1333 653,-1333 653,-1308 520,-1308"/>
<text text-anchor="start" x="523" y="-1314.8" font-family="Times,serif" font-size="16.00">row_id</text>
<polygon fill="#54ff9f" stroke="none" points="653,-1308 653,-1333 713,-1333 713,-1308 653,-1308"/>
<polygon fill="none" stroke="black" points="653,-1308 653,-1333 713,-1333 713,-1308 653,-1308"/>
<text text-anchor="start" x="660" y="-1314.8" font-family="Times,serif" font-size="16.00">bigint+</text>
<polygon fill="#54ff9f" stroke="none" points="713,-1308 713,-1333 1054,-1333 1054,-1308 713,-1308"/>
<polygon fill="none" stroke="black" points="713,-1308 713,-1333 1054,-1333 1054,-1308 713,-1308"/>
<text text-anchor="start" x="716" y="-1316.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Synthetic Unique Row Key</text>
<polygon fill="none" stroke="black" points="520,-1283 520,-1308 653,-1308 653,-1283 520,-1283"/>
<text text-anchor="start" x="523" y="-1289.8" font-family="Times,serif" font-size="16.00">stake_public_key</text>
<polygon fill="none" stroke="black" points="653,-1283 653,-1308 713,-1308 713,-1283 653,-1283"/>
<text text-anchor="start" x="671" y="-1289.8" font-family="Times,serif" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="713,-1283 713,-1308 1054,-1308 1054,-1283 713,-1283"/>
<text text-anchor="start" x="716" y="-1291.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The voters Stake Public Key</text>
<polygon fill="none" stroke="black" points="520,-1249 520,-1283 653,-1283 653,-1249 520,-1249"/>
<text text-anchor="start" x="523" y="-1260.4" font-family="Times,serif" font-size="16.00">snapshot_id</text>
<polygon fill="none" stroke="black" points="653,-1249 653,-1283 713,-1283 713,-1249 653,-1249"/>
<text text-anchor="start" x="661" y="-1260.4" font-family="Times,serif" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="713,-1249 713,-1283 1054,-1283 1054,-1249 713,-1249"/>
<text text-anchor="start" x="716" y="-1267.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The snapshot this contribution was</text>
<text text-anchor="start" x="716" y="-1253.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">recorded from.</text>
<polygon fill="none" stroke="black" points="520,-1215 520,-1249 653,-1249 653,-1215 520,-1215"/>
<text text-anchor="start" x="523" y="-1226.4" font-family="Times,serif" font-size="16.00">voting_key</text>
<polygon fill="none" stroke="black" points="653,-1215 653,-1249 713,-1249 713,-1215 653,-1215"/>
<text text-anchor="start" x="671" y="-1227.4" font-family="Times,serif" font-style="italic" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="713,-1215 713,-1249 1054,-1249 1054,-1215 713,-1215"/>
<text text-anchor="start" x="716" y="-1233.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The voting key. &#160;If this is NULL it is</text>
<text text-anchor="start" x="716" y="-1219.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">the raw staked ADA.</text>
<polygon fill="none" stroke="black" points="520,-1181 520,-1215 653,-1215 653,-1181 520,-1181"/>
<text text-anchor="start" x="523" y="-1192.4" font-family="Times,serif" font-size="16.00">voting_weight</text>
<polygon fill="none" stroke="black" points="653,-1181 653,-1215 713,-1215 713,-1181 653,-1181"/>
<text text-anchor="start" x="661" y="-1193.4" font-family="Times,serif" font-style="italic" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="713,-1181 713,-1215 1054,-1215 1054,-1181 713,-1181"/>
<text text-anchor="start" x="716" y="-1199.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The weight this voting key gets of the</text>
<text text-anchor="start" x="716" y="-1185.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">total.</text>
<polygon fill="none" stroke="black" points="520,-1147 520,-1181 653,-1181 653,-1147 520,-1147"/>
<text text-anchor="start" x="523" y="-1158.4" font-family="Times,serif" font-size="16.00">voting_key_idx</text>
<polygon fill="none" stroke="black" points="653,-1147 653,-1181 713,-1181 713,-1147 653,-1147"/>
<text text-anchor="start" x="661" y="-1159.4" font-family="Times,serif" font-style="italic" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="713,-1147 713,-1181 1054,-1181 1054,-1147 713,-1147"/>
<text text-anchor="start" x="716" y="-1165.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The index from 0 of the keys in the</text>
<text text-anchor="start" x="716" y="-1151.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">delegation array.</text>
<polygon fill="none" stroke="black" points="520,-1113 520,-1147 653,-1147 653,-1113 520,-1113"/>
<text text-anchor="start" x="523" y="-1124.4" font-family="Times,serif" font-size="16.00">value</text>
<polygon fill="none" stroke="black" points="653,-1113 653,-1147 713,-1147 713,-1113 653,-1113"/>
<text text-anchor="start" x="664.5" y="-1124.4" font-family="Times,serif" font-size="16.00">bigint</text>
<polygon fill="none" stroke="black" points="713,-1113 713,-1147 1054,-1147 1054,-1113 713,-1113"/>
<text text-anchor="start" x="716" y="-1131.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The amount of ADA contributed to this</text>
<text text-anchor="start" x="716" y="-1117.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">voting key from the stake address</text>
<polygon fill="none" stroke="black" points="520,-1088 520,-1113 653,-1113 653,-1088 520,-1088"/>
<text text-anchor="start" x="523" y="-1094.8" font-family="Times,serif" font-size="16.00">voting_group</text>
<polygon fill="none" stroke="black" points="653,-1088 653,-1113 713,-1113 713,-1088 653,-1088"/>
<text text-anchor="start" x="671" y="-1094.8" font-family="Times,serif" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="713,-1088 713,-1113 1054,-1113 1054,-1088 713,-1088"/>
<text text-anchor="start" x="716" y="-1096.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The group this contribution goes to.</text>
<polygon fill="none" stroke="black" points="520,-1040 520,-1088 653,-1088 653,-1040 520,-1040"/>
<text text-anchor="start" x="523" y="-1058.4" font-family="Times,serif" font-size="16.00">reward_address</text>
<polygon fill="none" stroke="black" points="653,-1040 653,-1088 713,-1088 713,-1040 653,-1040"/>
<text text-anchor="start" x="671" y="-1059.4" font-family="Times,serif" font-style="italic" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="713,-1040 713,-1088 1054,-1088 1054,-1040 713,-1040"/>
<text text-anchor="start" x="716" y="-1072.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Currently Unused. &#160;Should be the Stake</text>
<text text-anchor="start" x="716" y="-1058.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Rewards address of the voter (currently</text>
<text text-anchor="start" x="716" y="-1044.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">unknown.)</text>
<polygon fill="#333333" stroke="none" points="520,-1018 520,-1040 1054,-1040 1054,-1018 520,-1018"/>
<polygon fill="none" stroke="black" points="520,-1018 520,-1040 1054,-1040 1054,-1018 520,-1018"/>
<text text-anchor="start" x="523" y="-1024.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">Individual Contributions from stake public keys to voting keys.</text>
</g>
<!-- snapshot -->
<g id="node3" class="node">
<title>snapshot</title>
<polygon fill="#009879" stroke="none" points="1090,-980 1090,-1010 1707,-1010 1707,-980 1090,-980"/>
<polygon fill="none" stroke="black" points="1090,-980 1090,-1010 1707,-1010 1707,-980 1090,-980"/>
<text text-anchor="start" x="1353" y="-989" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">snapshot</text>
<polygon fill="none" stroke="black" points="1090,-953 1090,-980 1292,-980 1292,-953 1090,-953"/>
<text text-anchor="start" x="1156.5" y="-960.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="1292,-953 1292,-980 1365,-980 1365,-953 1292,-953"/>
<text text-anchor="start" x="1308" y="-960.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Type</text>
<polygon fill="none" stroke="black" points="1365,-953 1365,-980 1707,-980 1707,-953 1365,-953"/>
<text text-anchor="start" x="1485.5" y="-960.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Description</text>
<polygon fill="#54ff9f" stroke="none" points="1090,-928 1090,-953 1292,-953 1292,-928 1090,-928"/>
<polygon fill="none" stroke="black" points="1090,-928 1090,-953 1292,-953 1292,-928 1090,-928"/>
<text text-anchor="start" x="1093" y="-934.8" font-family="Times,serif" font-size="16.00">row_id</text>
<polygon fill="#54ff9f" stroke="none" points="1292,-928 1292,-953 1365,-953 1365,-928 1292,-928"/>
<polygon fill="none" stroke="black" points="1292,-928 1292,-953 1365,-953 1365,-928 1292,-928"/>
<text text-anchor="start" x="1302" y="-934.8" font-family="Times,serif" font-size="16.00">integer+</text>
<polygon fill="#54ff9f" stroke="none" points="1365,-928 1365,-953 1707,-953 1707,-928 1365,-928"/>
<polygon fill="none" stroke="black" points="1365,-928 1365,-953 1707,-953 1707,-928 1365,-928"/>
<text text-anchor="start" x="1368" y="-936.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">none</text>
<polygon fill="none" stroke="black" points="1090,-903 1090,-928 1292,-928 1292,-903 1090,-903"/>
<text text-anchor="start" x="1093" y="-909.8" font-family="Times,serif" font-size="16.00">event</text>
<polygon fill="none" stroke="black" points="1292,-903 1292,-928 1365,-928 1365,-903 1292,-903"/>
<text text-anchor="start" x="1306.5" y="-909.8" font-family="Times,serif" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="1365,-903 1365,-928 1707,-928 1707,-903 1365,-903"/>
<text text-anchor="start" x="1368" y="-911.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The event id this snapshot was for.</text>
<polygon fill="none" stroke="black" points="1090,-813 1090,-903 1292,-903 1292,-813 1090,-813"/>
<text text-anchor="start" x="1093" y="-852.4" font-family="Times,serif" font-size="16.00">as_at</text>
<polygon fill="none" stroke="black" points="1292,-813 1292,-903 1365,-903 1365,-813 1292,-813"/>
<text text-anchor="start" x="1295" y="-852.4" font-family="Times,serif" font-size="16.00">timestamp</text>
<polygon fill="none" stroke="black" points="1365,-813 1365,-903 1707,-903 1707,-813 1365,-813"/>
<text text-anchor="start" x="1368" y="-887.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The time the snapshot was collected</text>
<text text-anchor="start" x="1368" y="-873.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">from dbsync.</text>
<text text-anchor="start" x="1368" y="-859.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">This is the snapshot *DEADLINE*, i.e the</text>
<text text-anchor="start" x="1368" y="-845.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">time when registrations are final.</text>
<text text-anchor="start" x="1368" y="-831.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">(Should be the slot time the</text>
<text text-anchor="start" x="1368" y="-817.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">dbsync_snapshot_cmd was run against.)</text>
<polygon fill="none" stroke="black" points="1090,-788 1090,-813 1292,-813 1292,-788 1090,-788"/>
<text text-anchor="start" x="1093" y="-794.8" font-family="Times,serif" font-size="16.00">as_at_slotno</text>
<polygon fill="none" stroke="black" points="1292,-788 1292,-813 1365,-813 1365,-788 1292,-788"/>
<text text-anchor="start" x="1306.5" y="-794.8" font-family="Times,serif" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="1365,-788 1365,-813 1707,-813 1707,-788 1365,-788"/>
<text text-anchor="start" x="1368" y="-796.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">none</text>
<polygon fill="none" stroke="black" points="1090,-726 1090,-788 1292,-788 1292,-726 1090,-726"/>
<text text-anchor="start" x="1093" y="-751.4" font-family="Times,serif" font-size="16.00">last_updated</text>
<polygon fill="none" stroke="black" points="1292,-726 1292,-788 1365,-788 1365,-726 1292,-726"/>
<text text-anchor="start" x="1295" y="-751.4" font-family="Times,serif" font-size="16.00">timestamp</text>
<polygon fill="none" stroke="black" points="1365,-726 1365,-788 1707,-788 1707,-726 1365,-726"/>
<text text-anchor="start" x="1368" y="-772.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The last time the snapshot was run</text>
<text text-anchor="start" x="1368" y="-758.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">(Should be the latest block time taken</text>
<text text-anchor="start" x="1368" y="-744.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">from dbsync just before the snapshot</text>
<text text-anchor="start" x="1368" y="-730.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">was run.)</text>
<polygon fill="none" stroke="black" points="1090,-701 1090,-726 1292,-726 1292,-701 1090,-701"/>
<text text-anchor="start" x="1093" y="-707.8" font-family="Times,serif" font-size="16.00">last_updated_slotno</text>
<polygon fill="none" stroke="black" points="1292,-701 1292,-726 1365,-726 1365,-701 1292,-701"/>
<text text-anchor="start" x="1306.5" y="-707.8" font-family="Times,serif" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="1365,-701 1365,-726 1707,-726 1707,-701 1365,-701"/>
<text text-anchor="start" x="1368" y="-709.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">none</text>
<polygon fill="none" stroke="black" points="1090,-653 1090,-701 1292,-701 1292,-653 1090,-653"/>
<text text-anchor="start" x="1093" y="-671.4" font-family="Times,serif" font-size="16.00">final</text>
<polygon fill="none" stroke="black" points="1292,-653 1292,-701 1365,-701 1365,-653 1292,-653"/>
<text text-anchor="start" x="1303.5" y="-671.4" font-family="Times,serif" font-size="16.00">boolean</text>
<polygon fill="none" stroke="black" points="1365,-653 1365,-701 1707,-701 1707,-653 1365,-653"/>
<text text-anchor="start" x="1368" y="-685.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Is the snapshot Final?</text>
<text text-anchor="start" x="1368" y="-671.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">No more updates will occur to this</text>
<text text-anchor="start" x="1368" y="-657.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">record once set.</text>
<polygon fill="none" stroke="black" points="1090,-619 1090,-653 1292,-653 1292,-619 1090,-619"/>
<text text-anchor="start" x="1093" y="-630.4" font-family="Times,serif" font-size="16.00">dbsync_snapshot_cmd</text>
<polygon fill="none" stroke="black" points="1292,-619 1292,-653 1365,-653 1365,-619 1292,-619"/>
<text text-anchor="start" x="1316.5" y="-631.4" font-family="Times,serif" font-style="italic" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="1365,-619 1365,-653 1707,-653 1707,-619 1365,-619"/>
<text text-anchor="start" x="1368" y="-637.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The name of the command run to collect</text>
<text text-anchor="start" x="1368" y="-623.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">the snapshot from dbsync.</text>
<polygon fill="none" stroke="black" points="1090,-571 1090,-619 1292,-619 1292,-571 1090,-571"/>
<text text-anchor="start" x="1093" y="-589.4" font-family="Times,serif" font-size="16.00">dbsync_snapshot_params</text>
<polygon fill="none" stroke="black" points="1292,-571 1292,-619 1365,-619 1365,-571 1292,-571"/>
<text text-anchor="start" x="1311" y="-590.4" font-family="Times,serif" font-style="italic" font-size="16.00">jsonb</text>
<polygon fill="none" stroke="black" points="1365,-571 1365,-619 1707,-619 1707,-571 1365,-571"/>
<text text-anchor="start" x="1368" y="-603.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The parameters passed to the command,</text>
<text text-anchor="start" x="1368" y="-589.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">each parameter is a key and its value is</text>
<text text-anchor="start" x="1368" y="-575.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">the value of the parameter.</text>
<polygon fill="none" stroke="black" points="1090,-481 1090,-571 1292,-571 1292,-481 1090,-481"/>
<text text-anchor="start" x="1093" y="-520.4" font-family="Times,serif" font-size="16.00">dbsync_snapshot_data</text>
<polygon fill="none" stroke="black" points="1292,-481 1292,-571 1365,-571 1365,-481 1292,-481"/>
<text text-anchor="start" x="1311.5" y="-521.4" font-family="Times,serif" font-style="italic" font-size="16.00">bytea</text>
<polygon fill="none" stroke="black" points="1365,-481 1365,-571 1707,-571 1707,-481 1365,-481"/>
<text text-anchor="start" x="1368" y="-555.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The BROTLI COMPRESSED raw json result</text>
<text text-anchor="start" x="1368" y="-541.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">stored as BINARY from the dbsync</text>
<text text-anchor="start" x="1368" y="-527.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">snapshot.</text>
<text text-anchor="start" x="1368" y="-513.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">(This is JSON data but we store as raw</text>
<text text-anchor="start" x="1368" y="-499.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">text to prevent any processing of it,</text>
<text text-anchor="start" x="1368" y="-485.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">and BROTLI compress to save space).</text>
<polygon fill="none" stroke="black" points="1090,-391 1090,-481 1292,-481 1292,-391 1090,-391"/>
<text text-anchor="start" x="1093" y="-430.4" font-family="Times,serif" font-size="16.00">dbsync_snapshot_error</text>
<polygon fill="none" stroke="black" points="1292,-391 1292,-481 1365,-481 1365,-391 1292,-391"/>
<text text-anchor="start" x="1311.5" y="-431.4" font-family="Times,serif" font-style="italic" font-size="16.00">bytea</text>
<polygon fill="none" stroke="black" points="1365,-391 1365,-481 1707,-481 1707,-391 1365,-391"/>
<text text-anchor="start" x="1368" y="-465.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The BROTLI COMPRESSED raw json errors</text>
<text text-anchor="start" x="1368" y="-451.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">stored as BINARY from the dbsync</text>
<text text-anchor="start" x="1368" y="-437.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">snapshot.</text>
<text text-anchor="start" x="1368" y="-423.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">(This is JSON data but we store as raw</text>
<text text-anchor="start" x="1368" y="-409.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">text to prevent any processing of it,</text>
<text text-anchor="start" x="1368" y="-395.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">and BROTLI compress to save space).</text>
<polygon fill="none" stroke="black" points="1090,-301 1090,-391 1292,-391 1292,-301 1090,-301"/>
<text text-anchor="start" x="1093" y="-340.4" font-family="Times,serif" font-size="16.00">dbsync_snapshot_unregistered</text>
<polygon fill="none" stroke="black" points="1292,-301 1292,-391 1365,-391 1365,-301 1292,-301"/>
<text text-anchor="start" x="1311.5" y="-341.4" font-family="Times,serif" font-style="italic" font-size="16.00">bytea</text>
<polygon fill="none" stroke="black" points="1365,-301 1365,-391 1707,-391 1707,-301 1365,-301"/>
<text text-anchor="start" x="1368" y="-375.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The BROTLI COMPRESSED unregistered</text>
<text text-anchor="start" x="1368" y="-361.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">voting power stored as BINARY from the</text>
<text text-anchor="start" x="1368" y="-347.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">dbsync snapshot.</text>
<text text-anchor="start" x="1368" y="-333.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">(This is JSON data but we store as raw</text>
<text text-anchor="start" x="1368" y="-319.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">text to prevent any processing of it,</text>
<text text-anchor="start" x="1368" y="-305.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">and BROTLI compress to save space).</text>
<polygon fill="none" stroke="black" points="1090,-197 1090,-301 1292,-301 1292,-197 1090,-197"/>
<text text-anchor="start" x="1093" y="-243.4" font-family="Times,serif" font-size="16.00">drep_data</text>
<polygon fill="none" stroke="black" points="1292,-197 1292,-301 1365,-301 1365,-197 1292,-197"/>
<text text-anchor="start" x="1311.5" y="-244.4" font-family="Times,serif" font-style="italic" font-size="16.00">bytea</text>
<polygon fill="none" stroke="black" points="1365,-197 1365,-301 1707,-301 1707,-197 1365,-197"/>
<text text-anchor="start" x="1368" y="-285.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The latest drep data obtained from GVC,</text>
<text text-anchor="start" x="1368" y="-271.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">and used in this snapshot calculation.</text>
<text text-anchor="start" x="1368" y="-257.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Should be in a form directly usable by</text>
<text text-anchor="start" x="1368" y="-243.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">the `catalyst_snapshot_cmd`</text>
<text text-anchor="start" x="1368" y="-229.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">However, in order to save space this</text>
<text text-anchor="start" x="1368" y="-215.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">data is stored as BROTLI COMPRESSED</text>
<text text-anchor="start" x="1368" y="-201.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">BINARY.</text>
<polygon fill="none" stroke="black" points="1090,-149 1090,-197 1292,-197 1292,-149 1090,-149"/>
<text text-anchor="start" x="1093" y="-167.4" font-family="Times,serif" font-size="16.00">catalyst_snapshot_cmd</text>
<polygon fill="none" stroke="black" points="1292,-149 1292,-197 1365,-197 1365,-149 1292,-149"/>
<text text-anchor="start" x="1316.5" y="-168.4" font-family="Times,serif" font-style="italic" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="1365,-149 1365,-197 1707,-197 1707,-149 1365,-149"/>
<text text-anchor="start" x="1368" y="-181.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The actual name of the command run</text>
<text text-anchor="start" x="1368" y="-167.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">to produce the catalyst voting power</text>
<text text-anchor="start" x="1368" y="-153.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">snapshot.</text>
<polygon fill="none" stroke="black" points="1090,-124 1090,-149 1292,-149 1292,-124 1090,-124"/>
<text text-anchor="start" x="1093" y="-130.8" font-family="Times,serif" font-size="16.00">catalyst_snapshot_params</text>
<polygon fill="none" stroke="black" points="1292,-124 1292,-149 1365,-149 1365,-124 1292,-124"/>
<text text-anchor="start" x="1311" y="-131.8" font-family="Times,serif" font-style="italic" font-size="16.00">jsonb</text>
<polygon fill="none" stroke="black" points="1365,-124 1365,-149 1707,-149 1707,-124 1365,-124"/>
<text text-anchor="start" x="1368" y="-132.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">none</text>
<polygon fill="none" stroke="black" points="1090,-34 1090,-124 1292,-124 1292,-34 1090,-34"/>
<text text-anchor="start" x="1093" y="-73.4" font-family="Times,serif" font-size="16.00">catalyst_snapshot_data</text>
<polygon fill="none" stroke="black" points="1292,-34 1292,-124 1365,-124 1365,-34 1292,-34"/>
<text text-anchor="start" x="1311.5" y="-74.4" font-family="Times,serif" font-style="italic" font-size="16.00">bytea</text>
<polygon fill="none" stroke="black" points="1365,-34 1365,-124 1707,-124 1707,-34 1365,-34"/>
<text text-anchor="start" x="1368" y="-108.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The BROTLI COMPRESSED raw yaml result</text>
<text text-anchor="start" x="1368" y="-94.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">stored as BINARY from the catalyst</text>
<text text-anchor="start" x="1368" y="-80.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">snapshot calculation.</text>
<text text-anchor="start" x="1368" y="-66.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">(This is YAML data but we store as raw</text>
<text text-anchor="start" x="1368" y="-52.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">text to prevent any processing of it,</text>
<text text-anchor="start" x="1368" y="-38.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">and BROTLI compress to save space).</text>
<polygon fill="#333333" stroke="none" points="1090,0 1090,-34 1707,-34 1707,0 1090,0"/>
<polygon fill="none" stroke="black" points="1090,0 1090,-34 1707,-34 1707,0 1090,0"/>
<text text-anchor="start" x="1093" y="-18.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">Raw snapshot data for an event.</text>
<text text-anchor="start" x="1093" y="-4.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">Only the latests snapshot per event is stored.</text>
</g>
<!-- contribution&#45;&gt;snapshot -->
<g id="edge6" class="edge">
<title>contribution:snapshot_id_out&#45;&gt;snapshot:row_id</title>
<path fill="none" stroke="black" d="M1054,-1266C1122.69,-1266 1028.75,-975.57 1079.65,-943.81"/>
<polygon fill="black" stroke="black" points="1080.27,-947 1089,-941 1078.43,-940.24 1080.27,-947"/>
</g>
<!-- event -->
<g id="node6" class="node">
<title>event</title>
<polygon fill="#009879" stroke="none" points="1751,-956 1751,-986 1826,-986 1826,-956 1751,-956"/>
<polygon fill="none" stroke="black" points="1751,-956 1751,-986 1826,-986 1826,-956 1751,-956"/>
<text text-anchor="start" x="1760.5" y="-965" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">event</text>
<polygon fill="none" stroke="black" points="1751,-929 1751,-956 1826,-956 1826,-929 1751,-929"/>
<text text-anchor="start" x="1754" y="-936.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="1751,-904 1751,-929 1826,-929 1826,-904 1751,-904"/>
<text text-anchor="start" x="1754" y="-910.8" font-family="Times,serif" font-size="16.00">row_id</text>
<polygon fill="#333333" stroke="none" points="1751,-882 1751,-904 1826,-904 1826,-882 1751,-882"/>
<polygon fill="none" stroke="black" points="1751,-882 1751,-904 1826,-904 1826,-882 1751,-882"/>
<text text-anchor="start" x="1754" y="-888.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">ABRIDGED</text>
</g>
<!-- snapshot&#45;&gt;event -->
<g id="edge4" class="edge">
<title>snapshot:event_out&#45;&gt;event:row_id</title>
<path fill="none" stroke="black" d="M1707,-916C1721.61,-916 1727.74,-916 1738.51,-916"/>
<polygon fill="black" stroke="black" points="1738.5,-919.5 1748.5,-916 1738.5,-912.5 1738.5,-919.5"/>
</g>
<!-- voteplan -->
<g id="node4" class="node">
<title>voteplan</title>
<polygon fill="#009879" stroke="none" points="2,-520 2,-550 482,-550 482,-520 2,-520"/>
<polygon fill="none" stroke="black" points="2,-520 2,-550 482,-550 482,-520 2,-520"/>
<text text-anchor="start" x="198.5" y="-529" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">voteplan</text>
<polygon fill="none" stroke="black" points="2,-493 2,-520 107,-520 107,-493 2,-493"/>
<text text-anchor="start" x="20" y="-500.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="107,-493 107,-520 166,-520 166,-493 107,-493"/>
<text text-anchor="start" x="116" y="-500.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Type</text>
<polygon fill="none" stroke="black" points="166,-493 166,-520 482,-520 482,-493 166,-493"/>
<text text-anchor="start" x="273.5" y="-500.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Description</text>
<polygon fill="#54ff9f" stroke="none" points="2,-468 2,-493 107,-493 107,-468 2,-468"/>
<polygon fill="none" stroke="black" points="2,-468 2,-493 107,-493 107,-468 2,-468"/>
<text text-anchor="start" x="5" y="-474.8" font-family="Times,serif" font-size="16.00">row_id</text>
<polygon fill="#54ff9f" stroke="none" points="107,-468 107,-493 166,-493 166,-468 107,-468"/>
<polygon fill="none" stroke="black" points="107,-468 107,-493 166,-493 166,-468 107,-468"/>
<text text-anchor="start" x="110" y="-474.8" font-family="Times,serif" font-size="16.00">integer+</text>
<polygon fill="#54ff9f" stroke="none" points="166,-468 166,-493 482,-493 482,-468 166,-468"/>
<polygon fill="none" stroke="black" points="166,-468 166,-493 482,-493 482,-468 166,-468"/>
<text text-anchor="start" x="169" y="-476.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">Synthetic Unique Key</text>
<polygon fill="none" stroke="black" points="2,-443 2,-468 107,-468 107,-443 2,-443"/>
<text text-anchor="start" x="5" y="-449.8" font-family="Times,serif" font-size="16.00">objective_id</text>
<polygon fill="none" stroke="black" points="107,-443 107,-468 166,-468 166,-443 107,-443"/>
<text text-anchor="start" x="114.5" y="-449.8" font-family="Times,serif" font-size="16.00">integer</text>
<polygon fill="none" stroke="black" points="166,-443 166,-468 482,-468 482,-443 166,-443"/>
<text text-anchor="start" x="169" y="-451.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">none</text>
<polygon fill="none" stroke="black" points="2,-395 2,-443 107,-443 107,-395 2,-395"/>
<text text-anchor="start" x="5" y="-413.4" font-family="Times,serif" font-size="16.00">id</text>
<polygon fill="none" stroke="black" points="107,-395 107,-443 166,-443 166,-395 107,-395"/>
<text text-anchor="start" x="112.5" y="-413.4" font-family="Times,serif" font-size="16.00">varchar</text>
<polygon fill="none" stroke="black" points="166,-395 166,-443 482,-443 482,-395 166,-395"/>
<text text-anchor="start" x="169" y="-427.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The ID of the Vote plan in the voting</text>
<text text-anchor="start" x="169" y="-413.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">ledger/bulletin board.</text>
<text text-anchor="start" x="169" y="-399.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">A Binary value encoded as hex.</text>
<polygon fill="none" stroke="black" points="2,-361 2,-395 107,-395 107,-361 2,-361"/>
<text text-anchor="start" x="5" y="-372.4" font-family="Times,serif" font-size="16.00">category</text>
<polygon fill="none" stroke="black" points="107,-361 107,-395 166,-395 166,-361 107,-361"/>
<text text-anchor="start" x="124.5" y="-372.4" font-family="Times,serif" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="166,-361 166,-395 482,-395 482,-361 166,-361"/>
<text text-anchor="start" x="169" y="-379.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The kind of vote which can be cast on</text>
<text text-anchor="start" x="169" y="-365.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">this vote plan.</text>
<polygon fill="none" stroke="black" points="2,-313 2,-361 107,-361 107,-313 2,-313"/>
<text text-anchor="start" x="5" y="-331.4" font-family="Times,serif" font-size="16.00">encryption_key</text>
<polygon fill="none" stroke="black" points="107,-313 107,-361 166,-361 166,-313 107,-313"/>
<text text-anchor="start" x="112.5" y="-332.4" font-family="Times,serif" font-style="italic" font-size="16.00">varchar</text>
<polygon fill="none" stroke="black" points="166,-313 166,-361 482,-361 482,-313 166,-313"/>
<text text-anchor="start" x="169" y="-345.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The public encryption key used.</text>
<text text-anchor="start" x="169" y="-331.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">ONLY if required by the voteplan</text>
<text text-anchor="start" x="169" y="-317.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">category.</text>
<polygon fill="none" stroke="black" points="2,-279 2,-313 107,-313 107,-279 2,-279"/>
<text text-anchor="start" x="5" y="-290.4" font-family="Times,serif" font-size="16.00">group_id</text>
<polygon fill="none" stroke="black" points="107,-279 107,-313 166,-313 166,-279 107,-279"/>
<text text-anchor="start" x="124.5" y="-291.4" font-family="Times,serif" font-style="italic" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="166,-279 166,-313 482,-313 482,-279 166,-279"/>
<text text-anchor="start" x="169" y="-297.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">The identifier of voting power token</text>
<text text-anchor="start" x="169" y="-283.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">used withing this plan.</text>
<polygon fill="none" stroke="black" points="2,-254 2,-279 107,-279 107,-254 2,-254"/>
<text text-anchor="start" x="5" y="-260.8" font-family="Times,serif" font-size="16.00">token_id</text>
<polygon fill="none" stroke="black" points="107,-254 107,-279 166,-279 166,-254 107,-254"/>
<text text-anchor="start" x="124.5" y="-261.8" font-family="Times,serif" font-style="italic" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="166,-254 166,-279 482,-279 482,-254 166,-254"/>
<text text-anchor="start" x="169" y="-262.6" font-family="Monospace" font-style="italic" font-size="14.00" fill="#7f7f7f">none</text>
<polygon fill="#333333" stroke="none" points="2,-232 2,-254 482,-254 482,-232 2,-232"/>
<polygon fill="none" stroke="black" points="2,-232 2,-254 482,-254 482,-232 2,-232"/>
<text text-anchor="start" x="5" y="-238.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">All Vote plans.</text>
</g>
<!-- voteplan&#45;&gt;objective -->
<g id="edge1" class="edge">
<title>voteplan:objective_id_out&#45;&gt;objective:row_id</title>
<path fill="none" stroke="black" d="M483,-456C548.63,-456 475.67,-700.6 520,-749 584.18,-819.07 634.46,-797.78 726.21,-796.1"/>
<polygon fill="black" stroke="black" points="726.03,-799.59 736,-796 725.97,-792.59 726.03,-799.59"/>
</g>
<!-- voteplan_category -->
<g id="node9" class="node">
<title>voteplan_category</title>
<polygon fill="#009879" stroke="none" points="691.5,-442 691.5,-472 882.5,-472 882.5,-442 691.5,-442"/>
<polygon fill="none" stroke="black" points="691.5,-442 691.5,-472 882.5,-472 882.5,-442 691.5,-442"/>
<text text-anchor="start" x="694.5" y="-451" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">voteplan_category</text>
<polygon fill="none" stroke="black" points="691.5,-415 691.5,-442 882.5,-442 882.5,-415 691.5,-415"/>
<text text-anchor="start" x="752.5" y="-422.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="691.5,-390 691.5,-415 882.5,-415 882.5,-390 691.5,-390"/>
<text text-anchor="start" x="694.5" y="-396.8" font-family="Times,serif" font-size="16.00">name</text>
<polygon fill="#333333" stroke="none" points="691.5,-368 691.5,-390 882.5,-390 882.5,-368 691.5,-368"/>
<polygon fill="none" stroke="black" points="691.5,-368 691.5,-390 882.5,-390 882.5,-368 691.5,-368"/>
<text text-anchor="start" x="694.5" y="-374.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">ABRIDGED</text>
</g>
<!-- voteplan&#45;&gt;voteplan_category -->
<g id="edge2" class="edge">
<title>voteplan:category_out&#45;&gt;voteplan_category:name</title>
<path fill="none" stroke="black" d="M483,-378C571.91,-378 595.53,-400.12 679.21,-401.89"/>
<polygon fill="black" stroke="black" points="678.96,-405.4 689,-402 679.04,-398.4 678.96,-405.4"/>
</g>
<!-- voting_group -->
<g id="node10" class="node">
<title>voting_group</title>
<polygon fill="#009879" stroke="none" points="718.5,-312 718.5,-342 855.5,-342 855.5,-312 718.5,-312"/>
<polygon fill="none" stroke="black" points="718.5,-312 718.5,-342 855.5,-342 855.5,-312 718.5,-312"/>
<text text-anchor="start" x="721.5" y="-321" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">voting_group</text>
<polygon fill="none" stroke="black" points="718.5,-285 718.5,-312 855.5,-312 855.5,-285 718.5,-285"/>
<text text-anchor="start" x="752.5" y="-292.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Column</text>
<polygon fill="none" stroke="black" points="718.5,-260 718.5,-285 855.5,-285 855.5,-260 718.5,-260"/>
<text text-anchor="start" x="721.5" y="-266.8" font-family="Times,serif" font-size="16.00">name</text>
<polygon fill="#333333" stroke="none" points="718.5,-238 718.5,-260 855.5,-260 855.5,-238 718.5,-238"/>
<polygon fill="none" stroke="black" points="718.5,-238 718.5,-260 855.5,-260 855.5,-238 718.5,-238"/>
<text text-anchor="start" x="721.5" y="-244.7" font-family="Monospace" font-style="italic" font-size="14.00" fill="white">ABRIDGED</text>
</g>
<!-- voteplan&#45;&gt;voting_group -->
<g id="edge3" class="edge">
<title>voteplan:group_id_out&#45;&gt;voting_group:name</title>
<path fill="none" stroke="black" d="M483,-296C583.87,-296 610.6,-273.66 706.26,-272.09"/>
<polygon fill="black" stroke="black" points="706.03,-275.58 716,-272 705.97,-268.58 706.03,-275.58"/>
</g>
<!-- voter&#45;&gt;snapshot -->
<g id="edge5" class="edge">
<title>voter:snapshot_id_out&#45;&gt;snapshot:row_id</title>
<path fill="none" stroke="black" d="M1028,-616C1097.65,-616 1025,-907.63 1079.64,-938.38"/>
<polygon fill="black" stroke="black" points="1078.45,-941.94 1089,-941 1080.16,-935.16 1078.45,-941.94"/>
</g>
<!-- LEGEND -->
<g id="node11" class="node">
<title>LEGEND</title>
<polygon fill="Pink" stroke="none" points="131,-1094 131,-1124 353,-1124 353,-1094 131,-1094"/>
<polygon fill="none" stroke="black" points="131,-1094 131,-1124 353,-1124 353,-1094 131,-1094"/>
<text text-anchor="start" x="202" y="-1103" font-family="Courier bold italic" font-weight="bold" font-size="20.00" fill="white">LEGEND</text>
<polygon fill="none" stroke="black" points="131,-1067 131,-1094 270,-1094 270,-1067 131,-1067"/>
<text text-anchor="start" x="180" y="-1074.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Type</text>
<polygon fill="none" stroke="black" points="270,-1067 270,-1094 353,-1094 353,-1067 270,-1067"/>
<text text-anchor="start" x="273" y="-1074.9" font-family="Courier bold" font-weight="bold" font-size="18.00">Example</text>
<polygon fill="#54ff9f" stroke="none" points="131,-1042 131,-1067 270,-1067 270,-1042 131,-1042"/>
<polygon fill="none" stroke="black" points="131,-1042 131,-1067 270,-1067 270,-1042 131,-1042"/>
<text text-anchor="start" x="134" y="-1048.8" font-family="Times,serif" font-size="16.00">Primary Key</text>
<polygon fill="#54ff9f" stroke="none" points="270,-1042 270,-1067 353,-1067 353,-1042 270,-1042"/>
<polygon fill="none" stroke="black" points="270,-1042 270,-1067 353,-1067 353,-1042 270,-1042"/>
<text text-anchor="start" x="285" y="-1048.8" font-family="Times,serif" font-size="16.00">integer+</text>
<polygon fill="none" stroke="black" points="131,-1017 131,-1042 270,-1042 270,-1017 131,-1017"/>
<text text-anchor="start" x="134" y="-1023.8" font-family="Times,serif" font-size="16.00">Standard Field</text>
<polygon fill="none" stroke="black" points="270,-1017 270,-1042 353,-1042 353,-1017 270,-1017"/>
<text text-anchor="start" x="294.5" y="-1023.8" font-family="Times,serif" font-size="16.00">bytea</text>
<polygon fill="none" stroke="black" points="131,-992 131,-1017 270,-1017 270,-992 131,-992"/>
<text text-anchor="start" x="134" y="-998.8" font-family="Times,serif" font-size="16.00">Nullable Field</text>
<polygon fill="none" stroke="black" points="270,-992 270,-1017 353,-1017 353,-992 270,-992"/>
<text text-anchor="start" x="299.5" y="-999.8" font-family="Times,serif" font-style="italic" font-size="16.00">text</text>
<polygon fill="none" stroke="black" points="131,-967 131,-992 270,-992 270,-967 131,-967"/>
<text text-anchor="start" x="134" y="-973.8" font-family="Times,serif" font-size="16.00">Sized Field</text>
<polygon fill="none" stroke="black" points="270,-967 270,-992 353,-992 353,-967 270,-967"/>
<text text-anchor="start" x="274.5" y="-973.8" font-family="Times,serif" font-size="16.00">varchar(32)</text>
<polygon fill="none" stroke="black" points="131,-942 131,-967 270,-967 270,-942 131,-942"/>
<text text-anchor="start" x="134" y="-948.8" font-family="Times,serif" font-size="16.00">Autoincrement Field</text>
<polygon fill="none" stroke="black" points="270,-942 270,-967 353,-967 353,-942 270,-942"/>
<text text-anchor="start" x="285" y="-948.8" font-family="Times,serif" font-size="16.00">integer+</text>
</g>
</g>
</svg>
</pre>
<h2 id="snapshot-schema"><a class="header" href="#snapshot-schema">Snapshot Schema</a></h2>
<pre><code class="language-sql">-- Catalyst Event Database

-- Voting Power Snapshot Table

CREATE TABLE snapshot (
    row_id SERIAL PRIMARY KEY,
    event INTEGER NOT NULL UNIQUE,
    as_at TIMESTAMP NOT NULL,
    as_at_slotno INTEGER NOT NULL,
    last_updated TIMESTAMP NOT NULL,
    last_updated_slotno INTEGER NOT NULL,

    final BOOLEAN NOT NULL,

    dbsync_snapshot_cmd          TEXT NULL,
    dbsync_snapshot_params       JSONB NULL,
    dbsync_snapshot_data         BYTEA NULL,
    dbsync_snapshot_error        BYTEA NULL,
    dbsync_snapshot_unregistered BYTEA NULL,

    drep_data                    BYTEA NULL,

    catalyst_snapshot_cmd        TEXT NULL,
    catalyst_snapshot_params     JSONB NULL,
    catalyst_snapshot_data       BYTEA NULL,

    FOREIGN KEY(event) REFERENCES event(row_id)  ON DELETE CASCADE
);

COMMENT ON TABLE snapshot IS
'Raw snapshot data for an event.
Only the latests snapshot per event is stored.';
COMMENT ON COLUMN snapshot.event is 'The event id this snapshot was for.';
COMMENT ON COLUMN snapshot.as_at is
'The time the snapshot was collected from dbsync.
This is the snapshot *DEADLINE*, i.e the time when registrations are final.
(Should be the slot time the dbsync_snapshot_cmd was run against.)';
COMMENT ON COLUMN snapshot.last_updated is
'The last time the snapshot was run
(Should be the latest block time taken from dbsync just before the snapshot was run.)';
COMMENT ON COLUMN snapshot.final is
'Is the snapshot Final?
No more updates will occur to this record once set.';

COMMENT ON COLUMN snapshot.dbsync_snapshot_cmd is     'The name of the command run to collect the snapshot from dbsync.';
COMMENT ON COLUMN snapshot.dbsync_snapshot_params is  'The parameters passed to the command, each parameter is a key and its value is the value of the parameter.';
COMMENT ON COLUMN snapshot.dbsync_snapshot_data is
'The BROTLI COMPRESSED raw json result stored as BINARY from the dbsync snapshot.
(This is JSON data but we store as raw text to prevent any processing of it, and BROTLI compress to save space).';
COMMENT ON COLUMN snapshot.dbsync_snapshot_error is
'The BROTLI COMPRESSED raw json errors stored as BINARY from the dbsync snapshot.
(This is JSON data but we store as raw text to prevent any processing of it, and BROTLI compress to save space).';
COMMENT ON COLUMN snapshot.dbsync_snapshot_unregistered is
'The BROTLI COMPRESSED unregistered voting power stored as BINARY from the dbsync snapshot.
(This is JSON data but we store as raw text to prevent any processing of it, and BROTLI compress to save space).';

COMMENT ON COLUMN snapshot.drep_data is
'The latest drep data obtained from GVC, and used in this snapshot calculation.
Should be in a form directly usable by the `catalyst_snapshot_cmd`
However, in order to save space this data is stored as BROTLI COMPRESSED BINARY.';

COMMENT ON COLUMN snapshot.catalyst_snapshot_cmd is  'The actual name of the command run to produce the catalyst voting power snapshot.';
COMMENT ON COLUMN snapshot.dbsync_snapshot_params is 'The parameters passed to the command, each parameter is a key and its value is the value of the parameter.';
COMMENT ON COLUMN snapshot.catalyst_snapshot_data is
'The BROTLI COMPRESSED raw yaml result stored as BINARY from the catalyst snapshot calculation.
(This is YAML data but we store as raw text to prevent any processing of it, and BROTLI compress to save space).';

-- voters

CREATE TABLE voter (
    row_id SERIAL8 PRIMARY KEY,

    voting_key TEXT NOT NULL,
    snapshot_id INTEGER NOT NULL,
    voting_group TEXT NOT NULL,

    voting_power BIGINT NOT NULL,

    FOREIGN KEY(snapshot_id) REFERENCES snapshot(row_id) ON DELETE CASCADE
);

CREATE UNIQUE INDEX unique_voter_id on voter (voting_key, voting_group, snapshot_id);

COMMENT ON TABLE voter IS 'Voting Power for every voting key.';
COMMENT ON COLUMN voter.voting_key is 'Either the voting key.';
COMMENT ON COLUMN voter.snapshot_id is 'The ID of the snapshot this record belongs to.';
COMMENT ON COLUMN voter.voting_group is 'The voter group the voter belongs to.';
COMMENT ON COLUMN voter.voting_power is 'Calculated Voting Power associated with this key.';

-- contributions

CREATE TABLE contribution (
    row_id SERIAL8 PRIMARY KEY,

    stake_public_key TEXT NOT NULL,
    snapshot_id INTEGER NOT NULL,

    voting_key TEXT NULL,
    voting_weight INTEGER NULL,
    voting_key_idx INTEGER NULL,
    value BIGINT NOT NULL,

    voting_group TEXT NOT NULL,

    reward_address TEXT NULL,

    FOREIGN KEY(snapshot_id) REFERENCES snapshot(row_id) ON DELETE CASCADE
);

CREATE UNIQUE INDEX unique_contribution_id ON contribution (stake_public_key, voting_key, voting_group, snapshot_id);

COMMENT ON TABLE contribution IS 'Individual Contributions from stake public keys to voting keys.';
COMMENT ON COLUMN contribution.row_id is 'Synthetic Unique Row Key';
COMMENT ON COLUMN contribution.stake_public_key IS 'The voters Stake Public Key';
COMMENT ON COLUMN contribution.snapshot_id IS 'The snapshot this contribution was recorded from.';

COMMENT ON COLUMN contribution.voting_key IS 'The voting key.  If this is NULL it is the raw staked ADA.';
COMMENT ON COLUMN contribution.voting_weight IS 'The weight this voting key gets of the total.';
COMMENT ON COLUMN contribution.voting_key_idx IS 'The index from 0 of the keys in the delegation array.';
COMMENT ON COLUMN contribution.value IS 'The amount of ADA contributed to this voting key from the stake address';

COMMENT ON COLUMN contribution.voting_group IS 'The group this contribution goes to.';

COMMENT ON COLUMN contribution.reward_address IS 'Currently Unused.  Should be the Stake Rewards address of the voter (currently unknown.)';

</code></pre>
<h2 id="vote-schema"><a class="header" href="#vote-schema">Vote Schema</a></h2>
<pre><code class="language-sql">-- Catalyst Event Database - VIT-SS Compatibility

-- vote storage (replicates on-chain data for easy querying)

CREATE TABLE ballot (
    row_id SERIAL8 PRIMARY KEY,
    objective      INTEGER NOT NULL,
    proposal       INTEGER NULL,

    voter          INTEGER NOT NULL,
    fragment_id    TEXT NOT NULL,
    cast_at        TIMESTAMP NOT NULL,
    choice         SMALLINT NULL,
    raw_fragment   BYTEA    NOT NULL,

    FOREIGN KEY(voter)               REFERENCES voter(row_id)  ON DELETE CASCADE,
    FOREIGN KEY(objective)           REFERENCES objective(row_id)  ON DELETE CASCADE,
    FOREIGN KEY(proposal)            REFERENCES proposal(row_id)  ON DELETE CASCADE
);

CREATE UNIQUE INDEX ballot_proposal_idx  ON ballot(proposal,fragment_id);
CREATE UNIQUE INDEX ballot_objective_idx ON ballot(objective,fragment_id);

COMMENT ON TABLE ballot IS 'All Ballots cast on an event.';
COMMENT ON COLUMN ballot.fragment_id is 'Unique ID of this Ballot';
COMMENT ON COLUMN ballot.voter is 'Reference to the Voter who cast the ballot';
COMMENT ON COLUMN ballot.objective is 'Reference to the Objective the ballot was for.';
COMMENT ON COLUMN ballot.proposal is
'Reference to the Proposal the ballot was for.
May be NULL if this ballot covers ALL proposals in the challenge.';
COMMENT ON COLUMN ballot.cast_at is 'When this ballot was recorded as properly cast';
COMMENT ON COLUMN ballot.choice is 'If a public vote, the choice on the ballot, otherwise NULL.';
COMMENT ON COLUMN ballot.raw_fragment is 'The raw ballot record.';

</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/input-output-hk/catalyst-core/edit/main/book/src/08_event-db/06_snapshot_tables.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../08_event-db/05_vote_plans.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../08_event-db/07_automation_support.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../08_event-db/05_vote_plans.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../08_event-db/07_automation_support.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
